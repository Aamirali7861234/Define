<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Fast-Parity Predictor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: sans-serif;
      background: #111;
      color: white;
      margin: 0;
      padding: 20px;
    }
    h2 { color: #0f0; }
    input, select, button {
      font-size: 18px;
      margin: 5px 0;
      padding: 10px;
      width: 100%;
      border-radius: 10px;
      border: none;
    }
    .result-box {
      margin-top: 20px;
      padding: 10px;
      background: #222;
      border-radius: 10px;
    }
    .green { color: #0f0; }
    .red { color: red; }
    .conf { font-weight: bold; }
    .history {
      max-height: 300px;
      overflow-y: auto;
      margin-top: 20px;
    }
    .countdown {
      color: yellow;
      font-size: 20px;
      margin-top: 10px;
    }
  </style>
</head>
<body>

  <h2>Fast-Parity Predictor</h2>

  <input type="text" id="periodInput" placeholder="Enter Period Number">
  <select id="colorInput">
    <option value="green">Green</option>
    <option value="red">Red</option>
  </select>
  <button onclick="submitResult()">Submit Result</button>

  <div class="result-box" id="predictionBox"></div>
  <div class="countdown" id="countdownBox"></div>

  <div class="history" id="historyBox"></div>

  <audio id="sound" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg" preload="auto"></audio>

  <script>
    let history = [];
    let wins = 0, losses = 0, balance = 0;
    let countdownActive = false;

    function submitResult() {
      const period = document.getElementById("periodInput").value;
      const color = document.getElementById("colorInput").value;
      if (!period || !color) return alert("Please enter both period and result!");

      const prev = history.slice(-5).map(h => h.color);
      const prediction = getPrediction(prev);
      const correct = prediction.color === color;
      const conf = prediction.conf;

      // Play sound
      document.getElementById("sound").play();

      // Update stats
      history.push({ period, color, predicted: prediction.color, conf, win: correct });
      if (correct) {
        wins++; balance += 100;
      } else {
        losses++; balance -= 100;
      }

      // Show prediction
      const resultBox = document.getElementById("predictionBox");
      resultBox.innerHTML = `
        <div>Next Period Prediction: <b class="${prediction.color}">${prediction.color.toUpperCase()}</b></div>
        <div>Confidence: <span class="conf">${conf}%</span></div>
        <div>Total: ${wins} Wins / ${losses} Losses — Balance: ₹${balance}</div>
      `;

      // Update history
      const historyBox = document.getElementById("historyBox");
      historyBox.innerHTML = history.slice().reverse().map(h =>
        `<div>#${h.period} — Actual: <b class="${h.color}">${h.color}</b>, Predicted: <b class="${h.predicted}">${h.predicted}</b> — ${h.win ? '<span class="green">WIN</span>' : '<span class="red">LOSS</span>'}</div>`
      ).join("");

      // Reset input for editing
      document.getElementById("periodInput").focus();

      // Auto Break every 3 games
      if (history.length % 3 === 0 && !countdownActive) {
        startCountdown();
      }
    }

    function getPrediction(pastColors) {
      let greenCount = pastColors.filter(c => c === "green").length;
      let redCount = pastColors.filter(c => c === "red").length;
      let prediction = "green";
      let conf = 50;

      if (greenCount > redCount) {
        prediction = "red";
        conf = 60 + Math.floor(Math.random() * 10);
      } else if (redCount > greenCount) {
        prediction = "green";
        conf = 60 + Math.floor(Math.random() * 10);
      } else {
        conf = 55;
      }

      return { color: prediction, conf };
    }

    function startCountdown() {
      countdownActive = true;
      let seconds = 180;
      const box = document.getElementById("countdownBox");

      const interval = setInterval(() => {
        let m = Math.floor(seconds / 60);
        let s = seconds % 60;
        box.innerText = `Break Time: ${m}:${s.toString().padStart(2, "0")}`;
        seconds--;

        if (seconds < 0) {
          clearInterval(interval);
          box.innerText = "";
          history = []; // auto reset after break
          wins = 0; losses = 0; balance = 0;
          document.getElementById("historyBox").innerHTML = "";
          countdownActive = false;
        }
      }, 1000);
    }
  </script>
</body>
</html>
